# L26：CSS 工程化概述



## 1 CSS 中存在的问题



### 1.1 类名冲突的问题

在书写一个 `CSS` 类时，是写全局的类呢，还是写多个层级选择后的类呢？

你会发现，怎么都不好——

- 过深的层级：不利于编写、阅读、压缩、复用；
- 过浅的层级：容易导致 **类名冲突**。

一旦样式多起来，这个问题就会变得越发严重——归根结底，就是棘手的 **类名冲突** 问题。



### 1.2 重复样式

这类问题就更普遍了。一些重复的样式值总是不断地出现在 `CSS` 代码中，维护起来极其困难。

比如，网站的配色方案通常要考虑以下几类要素：

- `primary`
- `info`
- `warn`
- `error`
- `success`

更多其他的颜色，一般都是从这些主色调中衍变来的。试想：如果这些颜色充斥到所有背景、文字、边框中，一旦要对颜色进行批量调整，这将是一个非常浩大的工程！



### 1.3 CSS 文件细分问题

在大型项目中，`CSS` 也需要被更细地拆分，以便后期维护。

比如一个轮播图的功能模块，它不仅需要依赖 `JS` 实现的功能，还需要依赖 `CSS` 渲染样式。既然 `JS` 都能做到仅关心轮播图，那 `CSS` 样式应该也要仅关注轮播图；由此类推，不同的功能依赖不同的 `CSS` 样式，而公共样式可以单独抽离，这样就形成了不同于过去的 `CSS` 文件结构：**文件越多、CSS 拆分得越细**。

而在真实场景下，我们却希望 **文件越少越好**，这和 `JS` 遇到的情况是一致的。

因此，对于 `CSS` ，也需要 **工程化管理**。

从另一个角度来说， `CSS` 的工程化会遇到 **更多的挑战**，因为 `CSS` 不像 `JS`，前者的语法本身经过这么多年并没有发生多少变化（`CSS3` 也仅仅新增了一些属性而已）。对于 `CSS` 语法本身的改变也是一个工程化的课题。



## 2 解决方案

这么多年来，官方一直没有提出方案来解决上述问题。一些第三方机构针对不同的问题，提出了自己的解决方案。



### 2.1 解决类名冲突

常见的解决方案如下：

#### 2.1.1 命名约定

即提供一种命名标准来解决类名冲突问题，常见标准有：

- `BEM`（:star: 本章重点介绍）
- `OOCSS`
- `AMCSS`
- `SMACSS`
- 其他



#### 2.1.2 CSS  in JS

这种方案非常 **大胆**，它觉得 `CSS` 语言本身几乎无可救药了，干脆直接用 `JS` 对象来表示样式，然后把样式直接应用到元素的 `style` 中。

这样一来，`CSS` 在充分利用 `JS` 的语言优势后，变成了一个个 `JS` 对象，就能实现——

- 用函数返回一个样式对象；
- 将公共样式提取到公共模块中备用；
- 利用 `JS` 的各种特性操作样式对象：混合、提取、拆分……
- 更多新写法

> [!tip]
>
> 该方案也在手机端的 `React Native` 中大行其道。后续课程会对该方案进行评价。



#### 2.1.3 CSS  module

这是另一种非常有趣且好用的 `CSS` 模块化方案，编写简单，绝对不重名。具体的课程中详细介绍。



### 2.2 解决重复样式的问题

#### 2.2.1 CSS  in js

该方案虽然利用 `JS` 语言特性来解决重复样式值的问题，但由于 **太过激进**，很多习惯写 `CSS` 的开发者往往不太适应。



#### 2.2.2 预编译器

某些第三方组织设计出一套 `CSS` 语言的 **进化版** 来解决该问题。它支持 **变量**、**函数** 等高级语法，然后经过编译器将其编译成为普通的 `CSS`。

这种方案特别像构建工具，不过它仅针对 `CSS`。

常见的预编译工具语言：

- `Less`
- `Sass`



### 2.3 解决 CSS 文件细分问题

这一部分就要依靠像 `Webpack` 这样的构建工具来解决了。

具体方式：利用特定的 `loader` 或 `plugin` 来打包、合并、压缩 `CSS` 文件。